"use strict";(self.webpackChunkbru_finance=self.webpackChunkbru_finance||[]).push([[31337],{31337:(e,n,t)=>{t.r(n),t.d(n,{default:()=>Fe});var o=t(70579),i=t(65043),r=t(28887),s=t(83423);function a(e){const n=e.toToken.chainId===e.onRampToken.token.chainId,t=(0,s.bv)(e.toToken.tokenAddress)===(0,s.bv)(e.onRampToken.token.tokenAddress);return!(n&&t)}var c=t(55397),d=t(99108),l=t(64185),u=t(55596),h=t(12265),x=t(63331);var m=t(49703),p=t(39680);function y(e,n){return(0,h.I)({...n,queryKey:["useBuyWithFiatQuote",e],queryFn:async()=>{if(!e)throw new Error("No params provided");return async function(e){try{const n=new URLSearchParams({toAddress:e.toAddress,fromCurrencySymbol:e.fromCurrencySymbol,toChainId:e.toChainId.toString(),toTokenAddress:e.toTokenAddress.toLowerCase()});e.fromAmount&&n.append("fromAmount",e.fromAmount),e.toAmount&&n.append("toAmount",e.toAmount),e.maxSlippageBPS&&n.append("maxSlippageBPS",e.maxSlippageBPS.toString()),e.isTestMode&&n.append("isTestMode",e.isTestMode.toString());const t=n.toString(),o="".concat((0,p._5)(),"?").concat(t),i=await(0,m.KI)(e.client)(o);if(!i.ok){const e=await i.json();if(e&&"error"in e)throw e;throw new Error("HTTP error! status: ".concat(i.status))}return(await i.json()).result}catch(n){throw console.error("Fetch error:",n),n}}(e)},enabled:!!e,retry(e,n){if(e>3)return!1;try{if("MINIMUM_PURCHASE_AMOUNT"===n.error.code)return!1}catch{return!0}return!0}})}var f,g=t(75383),j=t(43571),v=t(57528),b=t(83290),w=t(90852),C=t(46077),T=t(83609),k=t(58911),S=t(64396),E=t(300),F=t(34153);const A=(0,i.forwardRef)((function(e,n){return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(R,{ref:n,children:[(0,o.jsx)(E.w,{children:(0,o.jsx)(F.K0,{type:"button","aria-label":"Close",onClick:e.close,children:(0,o.jsx)(w.MKb,{width:S.RK.md,height:S.RK.md,style:{color:"inherit"}})})}),e.children]})})})),R=(0,k.jx)((()=>{const e=(0,C.Q)();return{zIndex:1e4,padding:S.YK.lg,borderTopLeftRadius:S.r8.xl,borderTopRightRadius:S.r8.xl,background:e.colors.modalBg,position:"absolute",bottom:0,left:0,right:0,animation:"".concat(B," 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.1)"),borderTop:"1px solid ".concat(e.colors.borderColor)}})),B=(0,b.i7)(f||(f=(0,v.A)(["\n  from {\n    opacity: 0;\n    transform: translateY(100px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n"]))),D=(0,k.jx)((()=>({backgroundColor:(0,C.Q)().colors.modalOverlayBg,zIndex:9999,position:"absolute",inset:0,animation:"".concat(T.I0," 400ms cubic-bezier(0.16, 1, 0.3, 1)")})));var W=t(99606),z=t(21969),L=t(4230),M=t(5961),I=t(97138),P=t(58572),N=t(14494),K=t(46025),O=t(31476),q=t(88760),_=t(38437),Y=t(53436);function V(e){const{estimatedSeconds:n,quoteIsLoading:t}=e;return(0,o.jsxs)(N.mc,{bg:"tertiaryBg",flex:"row",borderColor:"borderColor",style:{borderRadius:S.r8.md,borderTopLeftRadius:0,borderTopRightRadius:0,justifyContent:"space-between",alignItems:"center",borderWidth:"1px",borderStyle:"solid"},children:[(0,o.jsxs)(N.mc,{flex:"row",center:"y",gap:"xxs",color:"accentText",p:"sm",children:[(0,o.jsx)(w.O4,{width:S.RK.sm,height:S.RK.sm}),t?(0,o.jsx)(z.E,{height:S.J.xs,width:"50px",color:"borderColor"}):(0,o.jsx)(K.E,{size:"xs",color:"secondaryText",children:void 0!==n?"~".concat((0,Y.X)(n)):"--"})]}),(0,o.jsxs)(F.$n,{variant:"ghost",onClick:e.onViewFees,gap:"xs",children:[(0,o.jsx)(N.mc,{color:"accentText",flex:"row",center:"both",children:(0,o.jsx)(U,{size:S.RK.sm})}),(0,o.jsx)(K.E,{size:"xs",color:"secondaryText",children:"View Fees"})]})]})}const U=e=>(0,o.jsxs)("svg",{width:e.size,height:e.size,viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M9.5 1.5H2.5C1.94772 1.5 1.5 1.94772 1.5 2.5V9.5C1.5 10.0523 1.94772 10.5 2.5 10.5H9.5C10.0523 10.5 10.5 10.0523 10.5 9.5V2.5C10.5 1.94772 10.0523 1.5 9.5 1.5Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),(0,o.jsx)("path",{d:"M4.5 7.5L7.5 4.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})]});var H=t(64946);function $(e){return(0,o.jsxs)(N.mc,{bg:"tertiaryBg",borderColor:"borderColor",flex:"row",style:{borderRadius:S.r8.md,borderBottomRightRadius:0,borderBottomLeftRadius:0,borderWidth:"1px",borderStyle:"solid",borderBottom:"none",flexWrap:"nowrap",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsxs)(G,{disabled:e.disableCurrencySelection,variant:"ghost",onClick:e.onSelectCurrency,style:{minHeight:"64px",justifyContent:"flex-start",minWidth:"50%"},gap:"sm",children:[(0,o.jsx)(e.currency.icon,{size:S.RK.md}),(0,o.jsxs)(N.mc,{flex:"row",center:"y",gap:"xxs",children:[(0,o.jsx)(K.E,{color:"primaryText",children:e.currency.shorthand}),!e.disableCurrencySelection&&(0,o.jsx)(w.D3D,{width:S.RK.sm,height:S.RK.sm})]})]}),(0,o.jsx)("div",{style:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",alignItems:"flex-end",gap:S.YK.xxs,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",justifyContent:"center",paddingRight:S.YK.sm},children:e.isLoading?(0,o.jsx)(z.E,{width:"100px",height:S.J.lg}):(0,o.jsx)(K.E,{size:"lg",color:e.value?"primaryText":"secondaryText",children:e.value?"".concat((0,c.Z)(Number(e.value),4)):"--"})})]})}const G=(0,H.A)(F.$n)((()=>({"&[disabled]:hover":{borderColor:"transparent"}})));function Q(e){return(0,o.jsxs)("div",{children:[(0,o.jsx)(K.E,{size:"sm",children:"Pay with "}),(0,o.jsx)(L.h,{y:"xs"}),(0,o.jsxs)(N.mc,{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gridGap:S.YK.sm},children:[(0,o.jsx)(J,{isChecked:"creditCard"===e.selected,variant:"outline",onClick:()=>{e.onSelect("creditCard")},children:"Credit Card"}),(0,o.jsx)(J,{isChecked:"crypto"===e.selected,variant:"outline",onClick:()=>{e.onSelect("crypto")},children:"Crypto"})]})]})}const J=(0,H.A)(F.$n)((e=>{const n=(0,C.Q)();return{fontSize:S.J.sm,borderColor:e.isChecked?n.colors.accentText:n.colors.borderColor,"&:hover":{borderColor:e.isChecked?n.colors.accentText:n.colors.secondaryText},gap:S.YK.xs,paddingInline:S.YK.xxs,paddingBlock:S.YK.sm,width:"100%"}}));function Z(e,n){const t=(window.innerHeight-750)/2,o=(window.innerWidth-500)/2;return window.open("".concat(e,"&theme=").concat(n),"thirdweb Pay","width=".concat(500,", height=").concat(750,", top=").concat(t,", left=").concat(o))}var X=t(63752),ee=t(63248),ne=t(73650),te=t(14956),oe=t(85892),ie=t(84735),re=t(50503),se=t(32347),ae=t(40497);function ce(e){var n,t,r,s;const a=(0,ee.jE)(),{openedWindow:c}=e,d=(0,te.a)({intentId:e.intentId,client:e.client});let l="loading";"ON_RAMP_TRANSFER_FAILED"===(null===(n=d.data)||void 0===n?void 0:n.status)||"PAYMENT_FAILED"===(null===(t=d.data)||void 0===t?void 0:t.status)?l="failed":"CRYPTO_SWAP_FALLBACK"===(null===(r=d.data)||void 0===r?void 0:r.status)?l="partialSuccess":"ON_RAMP_TRANSFER_COMPLETED"===(null===(s=d.data)||void 0===s?void 0:s.status)&&(l="completed"),(0,i.useEffect)((()=>{var e,n;c&&d.data&&("CRYPTO_SWAP_REQUIRED"!==(null===(e=d.data)||void 0===e?void 0:e.status)&&"ON_RAMP_TRANSFER_COMPLETED"!==(null===(n=d.data)||void 0===n?void 0:n.status)||c.close())}),[d.data,c]);const u=(0,i.useRef)(!1);return(0,i.useEffect)((()=>{var e;u.current||"ON_RAMP_TRANSFER_COMPLETED"!==(null===(e=d.data)||void 0===e?void 0:e.status)||(u.current=!0,(0,oe.V)(a))}),[d.data,a]),(0,i.useEffect)((()=>{var n;"CRYPTO_SWAP_REQUIRED"===(null===(n=d.data)||void 0===n?void 0:n.status)&&e.onShowSwapFlow(d.data)}),[d.data,e.onShowSwapFlow]),(0,o.jsxs)(N.mc,{p:"lg",children:[(0,o.jsx)(N.rQ,{title:"Buy",onBack:e.onBack}),e.hasTwoSteps&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(L.h,{y:"lg"}),(0,o.jsx)(ie.g,{steps:2,currentStep:1}),(0,o.jsx)(L.h,{y:"sm"}),(0,o.jsxs)(K.E,{size:"xs",children:["Step 1 of 2 - Buying ",e.quote.onRampToken.token.symbol," with"," ",e.quote.fromCurrencyWithFees.currencySymbol]})]}),(0,o.jsx)(de,{uiStatus:l,onDone:e.onDone,fiatStatus:d.data,client:e.client,isBuyForTx:e.isBuyForTx,quote:e.quote,isEmbed:e.isEmbed})]})}function de(e){const{uiStatus:n}=e,t=e.fiatStatus?(0,se.A)(e.fiatStatus):void 0,i=e.fiatStatus&&"NOT_FOUND"!==e.fiatStatus.status?e.fiatStatus:void 0,r=e.quote.onRampToken,s=(0,o.jsx)(ae.i,{client:e.client,token:null!==i&&void 0!==i&&i.source?{chainId:i.source.token.chainId,address:i.source.token.tokenAddress,symbol:i.source.token.symbol||"",amount:i.source.amount}:{chainId:r.token.chainId,address:r.token.tokenAddress,symbol:r.token.symbol,amount:r.amount},fiat:{amount:e.quote.fromCurrencyWithFees.amount,currencySymbol:e.quote.fromCurrencyWithFees.currencySymbol},statusMeta:null!==i&&void 0!==i&&i.source&&t?{color:null===t||void 0===t?void 0:t.color,text:null===t||void 0===t?void 0:t.status,txHash:i.source.transactionHash}:void 0});return(0,o.jsxs)(N.mc,{children:[(0,o.jsx)(L.h,{y:"xl"}),"loading"===n&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(L.h,{y:"md"}),(0,o.jsx)(N.mc,{flex:"row",center:"x",children:(0,o.jsx)(M.y,{size:"3xl",color:"accentText"})}),(0,o.jsx)(L.h,{y:"md"}),(0,o.jsx)(K.E,{color:"primaryText",size:"lg",center:!0,children:"Buy Pending"}),(0,o.jsx)(L.h,{y:"sm"}),!(0,ne.Fr)()&&(0,o.jsx)(K.E,{center:!0,children:"Complete the purchase in popup"}),(0,o.jsx)(L.h,{y:"xxl"}),s]}),"failed"===n&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(L.h,{y:"md"}),(0,o.jsx)(N.mc,{flex:"row",center:"x",children:(0,o.jsx)(re.g,{size:S.RK["3xl"]})}),(0,o.jsx)(L.h,{y:"lg"}),(0,o.jsx)(K.E,{color:"primaryText",size:"lg",center:!0,children:"Transaction Failed"}),(0,o.jsx)(L.h,{y:"xxl"}),s]}),"completed"===n&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(L.h,{y:"md"}),(0,o.jsx)(N.mc,{flex:"row",center:"x",color:"success",children:(0,o.jsx)(w.KaV,{width:S.RK["3xl"],height:S.RK["3xl"]})}),(0,o.jsx)(L.h,{y:"md"}),(0,o.jsx)(K.E,{color:"primaryText",size:"lg",center:!0,children:"Buy Complete"}),e.fiatStatus&&"NOT_FOUND"!==e.fiatStatus.status&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(L.h,{y:"xxl"}),s,(0,o.jsx)(L.h,{y:"sm"})]}),!e.isEmbed&&(0,o.jsx)(F.$n,{variant:"accent",fullWidth:!0,onClick:e.onDone,children:e.isBuyForTx?"Continue Transaction":"Done"})]})]})}var le=t(76792),ue=t(49927);function he(e){const n=a(e.quote),[t,r]=(0,i.useState)(n?{id:"step-1"}:{id:"onramp-status"}),[s,c]=(0,i.useState)(e.openedWindow);return"step-1"===t.id?(0,o.jsx)(le.Y,{client:e.client,onBack:e.onBack,partialQuote:(0,le.z)(e.quote),step:1,onContinue:()=>{const n=Z(e.quote.onRampLink,e.theme);(0,X.b)({type:"fiat",intentId:e.quote.intentId}),c(n),r({id:"onramp-status"})}}):"onramp-status"===t.id?(0,o.jsx)(ce,{client:e.client,intentId:e.quote.intentId,onBack:e.onBack,onViewPendingTx:e.onViewPendingTx,hasTwoSteps:n,openedWindow:s,quote:e.quote,onDone:e.onDone,onShowSwapFlow:e=>{r({id:"postonramp-swap",data:e})},isBuyForTx:e.isBuyForTx,isEmbed:e.isEmbed}):"postonramp-swap"===t.id?(0,o.jsx)(ue.n,{status:t.data,quote:(0,le.z)(e.quote),client:e.client,onBack:e.onBack,onViewPendingTx:e.onViewPendingTx,onDone:e.onDone,onSwapFlowStarted:()=>{},isBuyForTx:e.isBuyForTx,isEmbed:e.isEmbed}):null}var xe=t(59430),me=t(24818);const pe=(0,t(9893).xH)({id:137,name:"Polygon",nativeCurrency:{name:"MATIC",symbol:"MATIC",decimals:18},blockExplorers:[{name:"PolygonScan",url:"https://polygonscan.com",apiUrl:"https://api.polygonscan.com/api"}]});var ye=t(49193),fe=t(83166);var ge=t(72033),je=t(67991);function ve(e){var n;const t=(0,l.r)(e.chain);return(0,o.jsxs)(N.mc,{children:[(0,o.jsx)("div",{onClick:e=>{var n;null===(n=e.currentTarget.querySelector("input"))||void 0===n||n.focus()},children:(0,o.jsxs)(N.mc,{flex:"row",center:"both",gap:"xs",style:{flexWrap:"nowrap"},children:[(0,o.jsx)(ge.pd,{variant:"outline",pattern:"^[0-9]*[.,]?[0-9]*$",inputMode:"decimal",placeholder:"0",type:"text","data-placeholder":""===e.value,value:e.value||"0",disabled:e.freezeAmount,onClick:n=>{""===e.value&&n.currentTarget.setSelectionRange(n.currentTarget.value.length,n.currentTarget.value.length)},onChange:n=>{let t=n.target.value;t.startsWith(".")&&(t="0".concat(t));const o=Number(t);Number.isNaN(o)||(t.startsWith("0")&&!t.startsWith("0.")?e.onChange(t.slice(1)):e.onChange(t))},style:{border:"none",fontSize:e.value.length>10?"26px":e.value.length>6?"34px":"50px",boxShadow:"none",padding:"0",paddingBlock:"2px",fontWeight:600,textAlign:"right",width:(()=>{let n=e.value.replace(".","").length;return e.value.includes(".")&&(n+=.3),"calc(".concat("".concat(Math.max(1,n),"ch")," + 6px)")})(),maxWidth:"calc(100% - 100px)"}}),(0,o.jsx)(je.C,{token:e.token,chain:e.chain,size:"lg",color:"secondaryText"})]})}),!e.hideTokenSelector&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(L.h,{y:"sm"}),(0,o.jsx)(N.mc,{flex:"row",center:"x",children:(0,o.jsxs)(be,{variant:"secondary",fullWidth:!0,style:{fontSize:S.J.sm},gap:"xxs",onClick:e.onSelectToken,disabled:e.freezeChainAndToken,children:[(0,o.jsxs)(N.mc,{flex:"row",center:"y",gap:"sm",children:[(0,o.jsx)(P.x,{token:e.token,chain:e.chain,size:"md",client:e.client}),(0,o.jsxs)(N.mc,{flex:"column",style:{gap:"4px"},children:[(0,o.jsx)(je.C,{token:e.token,chain:e.chain,size:"sm"}),null!==(n=t.data)&&void 0!==n&&n.name?(0,o.jsx)(K.E,{size:"xs",color:"secondaryText",children:t.data.name}):(0,o.jsx)(z.E,{width:"90px",height:S.J.xs})]})]}),(0,o.jsx)(w.D3D,{width:S.RK.sm,height:S.RK.sm,style:{marginLeft:"auto"}})]})})]})]})}const be=(0,H.A)(F.$n)((()=>{const e=(0,C.Q)();return{background:e.colors.tertiaryBg,border:"1px solid ".concat(e.colors.borderColor),justifyContent:"flex-start",transition:"background 0.3s",padding:S.YK.sm}}));var we=t(64887),Ce=t(95484),Te=t(27621);function ke(e){var n;const t=(0,l.r)(e.chain),i=(0,g.LH)(),r=(0,u.X)({address:null===i||void 0===i?void 0:i.address,chain:e.chain,tokenAddress:(0,_.r)(e.token)?void 0:e.token.address,client:e.client});return(0,o.jsxs)(N.mc,{bg:"tertiaryBg",borderColor:"borderColor",flex:"row",style:{borderRadius:S.r8.md,borderBottomRightRadius:0,borderBottomLeftRadius:0,borderWidth:"1px",borderStyle:"solid",borderBottom:"none",flexWrap:"nowrap",justifyContent:"space-between",minHeight:"64px",alignItems:"center"},children:[(0,o.jsxs)(F.$n,{variant:"ghost",onClick:e.onSelectToken,gap:"sm",style:{paddingInline:S.YK.sm,paddingBlock:S.YK.sm,minWidth:"50%",justifyContent:"flex-start"},disabled:e.freezeChainAndTokenSelection,children:[(0,o.jsx)(P.x,{token:e.token,chain:e.chain,size:"md",client:e.client}),(0,o.jsxs)(N.mc,{flex:"column",gap:"xxs",children:[(0,o.jsxs)(N.mc,{flex:"row",gap:"xs",center:"y",color:"primaryText",children:[(0,o.jsx)(je.C,{token:e.token,chain:e.chain,size:"sm"}),(0,o.jsx)(w.D3D,{width:S.RK.sm,height:S.RK.sm})]}),null!==(n=t.data)&&void 0!==n&&n.name?(0,o.jsxs)(K.E,{size:"xs",children:[" ",t.data.name]}):(0,o.jsx)(z.E,{width:"90px",height:S.J.xs})]})]}),(0,o.jsxs)("div",{style:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",alignItems:"flex-end",gap:S.YK.xxs,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",justifyContent:"center",paddingRight:S.YK.sm},children:[e.isLoading?(0,o.jsx)(z.E,{width:"120px",height:S.J.md,color:"borderColor"}):(0,o.jsx)(K.E,{size:"md",color:e.value?"primaryText":"secondaryText",style:{},children:(0,c.Z)(Number(e.value),4)||"--"}),(0,o.jsxs)(N.mc,{flex:"row",gap:"xxs",center:"y",color:"secondaryText",children:[(0,o.jsx)(Ce.l,{size:S.J.xs}),r.data?(0,o.jsx)(K.E,{size:"xs",color:"secondaryText",weight:500,children:(0,Te.j)(r.data,!0)}):(0,o.jsx)(z.E,{width:"70px",height:S.J.xs})]})]})]})}var Se=t(19387),Ee=t(99418);function Fe(e){const n=(0,Ee.Xw)(e.client);return n.data?(0,o.jsx)(Re,{...e,onViewPendingTx:e.onViewPendingTx,supportedDestinations:n.data,buyForTx:e.buyForTx}):(0,o.jsx)(j.x,{})}function Ae(e){const{payOptions:n}=e,[t,o]=(0,i.useState)(!1===n.buyWithCrypto?"creditCard":!1===n.buyWithFiat?"crypto":"creditCard"),[r,s]=(0,i.useState)({type:"main"}),[a,c]=(0,i.useState)(),{drawerRef:d,drawerOverlayRef:l,onClose:u}=function(){const e=(0,i.useRef)(null),n=(0,i.useRef)(null);return{drawerRef:e,drawerOverlayRef:n,onClose:t=>{if(e.current){var o;const i={easing:"cubic-bezier(0.175, 0.885, 0.32, 1.1)",fill:"forwards",duration:300},r=e.current.animate([{transform:"translateY(100%)",opacity:0}],i);null===(o=n.current)||void 0===o||o.animate([{opacity:0}],i),r.onfinish=t}else t()}}}();return{method:t,setMethod:o,screen:r,setScreen:s,drawerScreen:a,setDrawerScreen:c,drawerRef:d,drawerOverlayRef:l,closeDrawer:function(){u((()=>{c(void 0)}))},showMainScreen:function(){s({type:"main"})}}}function Re(e){var n,t,s;const{client:a,supportedDestinations:u,connectLocale:h,payOptions:x,buyForTx:m}=e,p=(0,g.LH)(),y=(0,g.wT)();(0,l.s)(u.map((e=>e.chain))||[],50);const{method:f,setMethod:j,screen:v,setScreen:b,drawerScreen:w,setDrawerScreen:C,drawerRef:T,drawerOverlayRef:k,closeDrawer:E,showMainScreen:R}=Ae({payOptions:x}),{tokenAmount:B,setTokenAmount:z,setHasEditedAmount:M,hasEditedAmount:I,toChain:P,setToChain:K,deferredTokenAmount:O,fromChain:Y,setFromChain:V,toToken:U,setToToken:H,fromToken:$,setFromToken:G,selectedCurrency:J}=function(e){var n,t,o,r,s,a;const l=(0,g.wT)(),{payOptions:u,buyForTx:h,supportedDestinations:x}=e,m=(null===(n=u.prefillBuy)||void 0===n?void 0:n.amount)||(h?String((0,c.Z)(Number((0,d.Ce)(h.cost-h.balance)),4)):""),[p,y]=(0,i.useState)(!1),[f,j]=(0,i.useState)(m),v=(0,ye.o)(f,300),[b,w]=(0,i.useState)((null===(t=u.prefillBuy)||void 0===t?void 0:t.chain)||(null===h||void 0===h?void 0:h.tx.chain)||(null===(o=x.find((e=>e.chain.id===(null===l||void 0===l?void 0:l.id))))||void 0===o?void 0:o.chain)||pe),[C,T]=(0,i.useState)((null===(r=u.prefillBuy)||void 0===r?void 0:r.token)||_.g),[k,S]=(0,i.useState)(!1!==u.buyWithCrypto&&(null===(s=u.buyWithCrypto)||void 0===s||null===(s=s.prefillSource)||void 0===s?void 0:s.chain)||pe),[E,F]=(0,i.useState)(!1!==u.buyWithCrypto&&(null===(a=u.buyWithCrypto)||void 0===a||null===(a=a.prefillSource)||void 0===a?void 0:a.token)||_.g);return{tokenAmount:f,setTokenAmount:j,hasEditedAmount:p,toChain:b,setToChain:w,deferredTokenAmount:v,fromChain:k,setFromChain:S,toToken:C,setToToken:T,fromToken:E,setFromToken:F,selectedCurrency:fe._O,setHasEditedAmount:y}}({payOptions:x,buyForTx:m,supportedDestinations:u}),{amountNeeded:Z}=function(e){const{buyForTx:n,hasEditedAmount:t,isMainScreen:o,setTokenAmount:r,account:s}=e,a=!t&&o,l=!o,[u,h]=(0,i.useState)(null===n||void 0===n?void 0:n.cost);return(0,i.useEffect)((()=>{if(!n||l)return;let e=!0;return async function t(){if(n&&e){try{const t=await(0,xe.j)(n.tx,null===s||void 0===s?void 0:s.address);if(!e)return;if(h(t),a&&t>n.balance){const e=String((0,c.Z)(Number((0,d.Ce)(t-n.balance)),4));r(e)}}catch{}await(0,me.u)(3e4),t()}}(),()=>{e=!1}}),[n,a,r,l,s]),{amountNeeded:u}}({setTokenAmount:z,buyForTx:m,hasEditedAmount:I,isMainScreen:"main"===v.type,account:p}),X=y&&B,ee=(0,Ee.mC)({client:e.client,destinationChainId:P.id,destinationTokenAddress:(0,_.r)(U)?r.DG:U.address}),ne=(0,i.useMemo)((()=>ze(u,x,e.supportedTokens)),[e.supportedTokens,u,x]),te=(0,i.useMemo)((()=>{if(ee.data)return ze(ee.data,x,e.supportedTokens)}),[e.supportedTokens,ee.data,x]),{showPaymentSelection:oe}=function(e){const{payOptions:n,supportedDestinations:t,toChain:o,toToken:s,method:a,setMethod:c}=e,{fiat:d,swap:l}=function(){const e=t.find((e=>e.chain.id===o.id));if(!e)return{fiat:!0,swap:!0};const n=(0,_.r)(s)?r.DG:s.address,i=e.tokens.find((e=>e.address.toLowerCase()===n.toLowerCase()));return i?{fiat:i.buyWithFiatEnabled,swap:i.buyWithCryptoEnabled}:{fiat:!0,swap:!0}}(),u=!1!==n.buyWithFiat&&d,h=!1!==n.buyWithCrypto&&l;return(0,i.useEffect)((()=>{(u||h)&&("creditCard"!==a||u||c("crypto"),"crypto"!==a||h||c("creditCard"))}),[u,h,a,c]),{showPaymentSelection:u&&h}}({payOptions:x,supportedDestinations:u,toChain:P,toToken:U,method:f,setMethod:j});if("node"===v.type)return v.node;if("screen-id"===v.type&&"select-to-token"===v.name){var ie,re;const n=u.map((e=>e.chain));return!1===(null===(ie=x.prefillBuy)||void 0===ie||null===(ie=ie.allowEdits)||void 0===ie?void 0:ie.token)?(0,o.jsx)(Le,{chains:n,client:e.client,connectLocale:e.connectLocale,setChain:K,showMainScreen:R}):(0,o.jsx)(q.T,{onBack:R,tokenList:((null!==P&&void 0!==P&&P.id?ne[P.id]:void 0)||[]).filter((e=>e.address!==r.DG)),onTokenSelect:e=>{H(e),R()},chain:P,chainSelection:!1!==(null===(re=x.prefillBuy)||void 0===re||null===(re=re.allowEdits)||void 0===re?void 0:re.chain)?{chains:n,select:e=>{K(e)}}:void 0,connectLocale:h,client:a})}if("screen-id"===v.type&&"select-from-token"===v.name&&ee.data&&te){var se,ae;const n=ee.data.map((e=>e.chain));return!1!==x.buyWithCrypto&&!1===(null===(se=x.buyWithCrypto)||void 0===se||null===(se=se.prefillSource)||void 0===se||null===(se=se.allowEdits)||void 0===se?void 0:se.token)?(0,o.jsx)(Le,{chains:n,client:e.client,connectLocale:e.connectLocale,setChain:V,showMainScreen:R}):(0,o.jsx)(q.T,{onBack:R,tokenList:((null!==Y&&void 0!==Y&&Y.id?te[Y.id]:void 0)||[]).filter((e=>e.address!==r.DG)),onTokenSelect:e=>{G(e),b({type:"main"})},chain:Y,chainSelection:!1!==x.buyWithCrypto&&!1!==(null===(ae=x.buyWithCrypto)||void 0===ae||null===(ae=ae.prefillSource)||void 0===ae||null===(ae=ae.allowEdits)||void 0===ae?void 0:ae.chain)?{chains:ee.data.map((e=>e.chain)),select:e=>V(e)}:void 0,connectLocale:h,client:a})}return(0,o.jsx)(N.mc,{animate:"fadein",children:(0,o.jsxs)("div",{onClick:e=>{w&&T.current&&!T.current.contains(e.target)&&(e.preventDefault(),e.stopPropagation(),E())},children:[w&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(D,{ref:k}),(0,o.jsx)(A,{ref:T,close:E,children:(0,o.jsx)(W.X,{children:w})})]}),(0,o.jsxs)(N.mc,{p:"lg",style:{paddingBottom:0},children:[(0,o.jsx)(N.rQ,{title:e.buyForTx?"Not enough ".concat(e.buyForTx.tokenSymbol):"Buy",onBack:e.onBack}),(0,o.jsx)(L.h,{y:"lg"}),!X&&(0,o.jsx)(L.h,{y:"xl"}),Z&&e.buyForTx?(0,o.jsx)(We,{amountNeeded:String((0,c.Z)(Number((0,d.Ce)(Z)),4)),buyForTx:e.buyForTx,client:a}):null,(0,o.jsx)(ve,{value:B,onChange:async e=>{M(!0),z(e)},freezeAmount:!1===(null===(n=x.prefillBuy)||void 0===n||null===(n=n.allowEdits)||void 0===n?void 0:n.amount),freezeChainAndToken:!1===(null===(t=x.prefillBuy)||void 0===t||null===(t=t.allowEdits)||void 0===t?void 0:t.chain)&&!1===(null===(s=x.prefillBuy)||void 0===s||null===(s=s.allowEdits)||void 0===s?void 0:s.token),token:U,chain:P,onSelectToken:()=>{b({type:"screen-id",name:"select-to-token"})},client:e.client,hideTokenSelector:!!e.buyForTx})]}),oe?(0,o.jsx)(L.h,{y:"lg"}):(0,o.jsx)(L.h,{y:"md"}),X&&(0,o.jsxs)(o.Fragment,{children:[oe&&(0,o.jsxs)(N.mc,{px:"lg",children:[(0,o.jsx)(Q,{selected:f,onSelect:j}),(0,o.jsx)(L.h,{y:"md"})]}),"crypto"===f&&p&&y&&(0,o.jsx)(Be,{...e,setScreen:b,setDrawerScreen:C,tokenAmount:O,toChain:P,toToken:U,fromChain:Y,fromToken:$,showFromTokenSelector:()=>{b({type:"screen-id",name:"select-from-token"})},account:p,activeChain:y}),"creditCard"===f&&p&&(0,o.jsx)(De,{...e,setScreen:b,setDrawerScreen:C,tokenAmount:O,toChain:P,toToken:U,closeDrawer:E,selectedCurrency:J,showCurrencySelector:()=>{},account:p}),(0,o.jsx)(L.h,{y:"sm"})]}),(0,o.jsxs)(N.mc,{px:"lg",flex:"column",gap:"sm",children:[!X&&(0,o.jsx)(o.Fragment,{children:!p&&e.connectButton?(0,o.jsx)("div",{children:e.connectButton}):(0,o.jsx)(F.$n,{variant:"accent",fullWidth:!0,disabled:!0,"data-disable":!0,children:"Continue"})}),p&&(0,o.jsx)(F.$n,{variant:"outline",fullWidth:!0,style:{padding:S.YK.xs,fontSize:S.J.sm},onClick:e.onViewPendingTx,children:"View all transactions"})]}),(0,o.jsx)(L.h,{y:"lg"})]})})}function Be(e){var n,t,i,s,a;const{setDrawerScreen:c,setScreen:d,account:l,client:m,toChain:p,tokenAmount:y,toToken:f,fromChain:g,fromToken:j,showFromTokenSelector:v,payOptions:b}=e,w=(0,u.X)({address:l.address,chain:g,tokenAddress:(0,_.r)(j)?void 0:j.address,client:m}),C=!y||g.id===p.id&&j===f?void 0:{fromAddress:l.address,fromChainId:g.id,fromTokenAddress:(0,_.r)(j)?r.DG:j.address,toChainId:p.id,toTokenAddress:(0,_.r)(f)?r.DG:f.address,toAmount:y,client:m},T=(k=C,S={staleTime:3e4,refetchInterval:3e4,gcTime:3e4},(0,h.I)({...S,queryKey:["buyWithCryptoQuote",k],queryFn:()=>{if(!k)throw new Error("Swap params are required");return(0,x.c)(k)},enabled:!!k,retry:(e,n)=>!(e>3)&&!n.message.includes("Minimum purchase")}));var k,S;const E=null===(n=T.data)||void 0===n?void 0:n.swapDetails.fromAmount,A=!!E&&!!w.data&&Number(w.data.displayValue)<Number(E),R=!T.data||A,B=e.activeChain.id!==g.id;const D=!1!==b.buyWithCrypto?null===(t=b.buyWithCrypto)||void 0===t?void 0:t.prefillSource:void 0;return(0,o.jsxs)(N.mc,{px:"lg",flex:"column",gap:"md",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)(ke,{value:E||"",onSelectToken:v,chain:g,token:j,isLoading:T.isLoading&&!E,client:m,freezeChainAndTokenSelection:!1===(null===D||void 0===D||null===(i=D.allowEdits)||void 0===i?void 0:i.chain)&&!1===(null===D||void 0===D||null===(s=D.allowEdits)||void 0===s?void 0:s.token)}),(0,o.jsx)(V,{quoteIsLoading:T.isLoading,estimatedSeconds:null===(a=T.data)||void 0===a?void 0:a.swapDetails.estimated.durationSeconds,onViewFees:function(){T.data&&c((0,o.jsxs)("div",{children:[(0,o.jsx)(K.E,{size:"lg",color:"primaryText",children:"Fees"}),(0,o.jsx)(L.h,{y:"lg"}),(0,o.jsx)(we.h,{quote:T.data,align:"left"})]}))}})]}),T.error&&(0,o.jsx)(K.E,{color:"danger",size:"sm",center:!0,children:function(e){const n="Unable to get price quote";try{if(e instanceof Error&&e.message.includes("Minimum")){return e.message.replace("Fetch failed: Error: ","")}return n}catch{return n}}(T.error)}),!B||T.isLoading||A||T.error?(0,o.jsx)(F.$n,{variant:R?"outline":"accent",fullWidth:!0,"data-disabled":R,disabled:R,onClick:async()=>{R||T.data&&d({type:"node",node:(0,o.jsx)(Se.K,{isBuyForTx:!!e.buyForTx,isEmbed:e.isEmbed,client:m,onBack:()=>{d({type:"main"})},buyWithCryptoQuote:T.data,account:l,onViewPendingTx:e.onViewPendingTx,isFiatFlow:!1,onDone:e.onDone,onTryAgain:()=>{d({type:"main"}),T.refetch()}})})},gap:"xs",children:A?(0,o.jsx)(K.E,{color:"danger",children:"Not Enough Funds"}):T.isLoading?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(M.y,{size:"sm",color:"accentText"}),"Getting price quote"]}):"Continue"}):(0,o.jsx)(I.b,{variant:"accent",fullWidth:!0,chain:g})]})}function De(e){var n,t;const{toToken:i,tokenAmount:s,account:c,client:d,setScreen:l,setDrawerScreen:u,toChain:h,showCurrencySelector:x,selectedCurrency:m}=e,p=e.payOptions.buyWithFiat,f=y(!1!==p&&s?{fromCurrencySymbol:"USD",toChainId:h.id,toAddress:c.address,toTokenAddress:(0,_.r)(i)?r.DG:i.address,toAmount:s,client:d,isTestMode:null===p||void 0===p?void 0:p.testMode}:void 0);const g=!f.data;return(0,o.jsxs)(N.mc,{px:"lg",flex:"column",gap:"md",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)($,{isLoading:f.isLoading,value:null===(n=f.data)||void 0===n?void 0:n.fromCurrencyWithFees.amount,client:d,currency:m,onSelectCurrency:x,disableCurrencySelection:!0}),(0,o.jsx)(V,{quoteIsLoading:f.isLoading,estimatedSeconds:null===(t=f.data)||void 0===t?void 0:t.estimatedDurationSeconds,onViewFees:function(){f.data&&u((0,o.jsxs)("div",{children:[(0,o.jsx)(K.E,{size:"lg",color:"primaryText",children:"Fees"}),(0,o.jsx)(L.h,{y:"lg"}),(0,o.jsx)(we.C,{quote:f.data})]}))}})]}),f.error&&(0,o.jsx)("div",{children:function(e){try{if("MINIMUM_PURCHASE_AMOUNT"===e.error.code){const n=e.error;return["Minimum purchase amount is $".concat(n.data.minimumAmountUSDCents/100),"Requested amount is $".concat(n.data.requestedAmountUSDCents/100)]}}catch{}return["Unable to get price quote"]}(f.error).map((e=>(0,o.jsx)(K.E,{color:"danger",size:"sm",center:!0,multiline:!0,children:e},e)))}),(0,o.jsx)(F.$n,{variant:g?"outline":"accent","data-disabled":g,disabled:g,fullWidth:!0,onClick:function(){if(!f.data)return;let n=null;a(f.data)||(n=Z(f.data.onRampLink,"string"===typeof e.theme?e.theme:e.theme.type),(0,X.b)({type:"fiat",intentId:f.data.intentId})),l({type:"node",node:(0,o.jsx)(he,{isBuyForTx:!!e.buyForTx,quote:f.data,onBack:()=>{l({type:"main"})},client:d,testMode:!1!==p&&(null===p||void 0===p?void 0:p.testMode)||!1,theme:"string"===typeof e.theme?e.theme:e.theme.type,onViewPendingTx:e.onViewPendingTx,openedWindow:n,onDone:e.onDone,isEmbed:e.isEmbed})})},gap:"xs",children:f.isLoading?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(M.y,{size:"sm",color:"accentText"}),"Getting price quote"]}):"Continue"})]})}function We(e){const n=(0,l.r)(e.buyForTx.tx.chain);return(0,o.jsxs)(N.mc,{children:[(0,o.jsx)(L.h,{y:"xs"}),(0,o.jsxs)(N.mc,{flex:"row",style:{justifyContent:"space-between"},children:[(0,o.jsx)(K.E,{size:"sm",children:"Amount Needed"}),(0,o.jsxs)(N.mc,{flex:"column",style:{alignItems:"flex-end"},children:[(0,o.jsxs)(N.mc,{flex:"row",gap:"xs",center:"y",children:[(0,o.jsxs)(K.E,{color:"primaryText",size:"sm",children:[e.amountNeeded," ",e.buyForTx.tokenSymbol]}),(0,o.jsx)(P.x,{chain:e.buyForTx.tx.chain,client:e.client,size:"sm",token:_.g})]}),(0,o.jsx)(L.h,{y:"xxs"}),n.data?(0,o.jsxs)(K.E,{size:"sm",children:[" ",n.data.name]}):(0,o.jsx)(z.E,{height:S.J.sm,width:"50px"})]})]}),(0,o.jsx)(L.h,{y:"md"}),(0,o.jsx)(N.N1,{}),(0,o.jsx)(L.h,{y:"md"}),(0,o.jsxs)(N.mc,{flex:"row",style:{justifyContent:"space-between"},children:[(0,o.jsx)(K.E,{size:"sm",children:"Your Balance"}),(0,o.jsxs)(N.mc,{flex:"row",gap:"xs",children:[(0,o.jsxs)(K.E,{color:"primaryText",size:"sm",children:[(0,c.Z)(Number((0,d.Ce)(e.buyForTx.balance)),4)," ",e.buyForTx.tokenSymbol]}),(0,o.jsx)(P.x,{chain:e.buyForTx.tx.chain,client:e.client,size:"sm",token:_.g})]})]}),(0,o.jsx)(L.h,{y:"md"}),(0,o.jsx)(N.N1,{}),(0,o.jsx)(L.h,{y:"lg"}),(0,o.jsx)(K.E,{center:!0,size:"sm",children:"Purchase"}),(0,o.jsx)(L.h,{y:"xxs"})]})}function ze(e,n,t){const o={},i=!1===n.buyWithFiat,r=!1===n.buyWithCrypto;for(const s of e)o[s.chain.id]=s.tokens.filter((e=>!(!e.buyWithCryptoEnabled||!e.buyWithFiatEnabled)||!(!e.buyWithCryptoEnabled&&i)&&!(!e.buyWithFiatEnabled&&r)));if(t)for(const s in t){const e=Number(s),n=t[e];n&&(o[e]=n)}return o}function Le(e){return(0,o.jsx)(O.H,{client:e.client,connectLocale:e.connectLocale,showTabs:!1,onBack:e.showMainScreen,chains:e.chains,closeModal:e.showMainScreen,networkSelector:{renderChain:n=>(0,o.jsx)(O.O,{chain:n.chain,confirming:!1,switchingFailed:!1,onClick:()=>{e.setChain(n.chain),e.showMainScreen()},client:e.client,connectLocale:e.connectLocale})}})}}}]);
//# sourceMappingURL=31337.16a5e9ef.chunk.js.map