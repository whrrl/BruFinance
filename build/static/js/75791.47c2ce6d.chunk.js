"use strict";(self.webpackChunkbru_finance=self.webpackChunkbru_finance||[]).push([[75791],{75791:(e,n,t)=>{t.r(n),t.d(n,{default:()=>$});var i=t(70579),r=t(73793),o=t(83530),s=t(43571),c=t(14126),l=t(65043),a=t(51739),d=t(83609),x=t(58911);const h=(0,x.jx)({animation:"".concat(d.I0," 0.15s ease-in")});var u,j=t(57528),g=t(83290),p=t(195),m=t(46077),y=t(64396),f=t(14494);function k(e){return(0,i.jsx)(w,{children:(0,i.jsx)(p.wE,{onComplete:()=>{e.onEnter()},maxLength:6,value:e.value,render:n=>{let{slots:t}=n;return(0,i.jsx)(f.mc,{flex:"row",gap:"xs",center:"both",children:t.map(((n,t)=>(0,i.jsx)(v,{...n,isInvalid:e.isInvalid},t)))})},onChange:n=>{e.setValue(n)}})})}const w=(0,x.jx)({"& input":{maxWidth:"100%"}});function v(e){return(0,i.jsxs)(b,{"data-active":e.isActive,"data-error":e.isInvalid,children:[null!==e.char&&(0,i.jsx)("div",{children:e.char}),e.hasFakeCaret&&(0,i.jsx)(E,{})]})}const C=(0,g.i7)(u||(u=(0,j.A)(["\n  0%, 100% {\n    opacity: 0;\n  },\n  50% {\n    opacity: 1;\n  }\n  "]))),E=(0,x.jx)((()=>{const e=(0,m.Q)();return{position:"absolute",pointerEvents:"none",inset:0,display:"flex",alignItems:"center",justifyContent:"center",animation:"".concat(C," 1s infinite"),"&::before":{content:"''",display:"block",width:"1.5px",height:"1em",backgroundColor:e.colors.primaryText}}})),b=(0,x.jx)((()=>{const e=(0,m.Q)();return{position:"relative",width:"40px",height:"40px",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",fontSize:y.J.md,padding:y.YK.xs,boxSizing:"border-box",transition:"color 200ms ease",border:"2px solid ".concat(e.colors.borderColor),"&[data-active='true']":{borderColor:e.colors.accentText},color:e.colors.primaryText,borderRadius:y.r8.lg,"&[data-error='true']":{borderColor:e.colors.danger}}}));var L=t(4230),S=t(5961),A=t(34153),T=t(46025),z=t(77466);function M(e){const{wallet:n,done:t,goBack:o,userInfo:s}=e,{client:c,chain:d,connectModal:x}=(0,r.c)(),u="wide"===x.size,j=e.locale,[g,p]=(0,l.useState)(""),[m,y]=(0,l.useState)("idle"),[w,v]=(0,l.useState)("sending"),[C]=(0,l.useState)("base"),E=(0,l.useCallback)((async()=>{p(""),y("idle"),v("sending");try{if("email"in s){const e=await(0,a.je)({email:s.email,strategy:"email",client:c});v(e)}else{if(!("phone"in s))throw new Error("Invalid userInfo");{const e=await(0,a.je)({phoneNumber:s.phone,strategy:"phone",client:c});v(e)}}}catch(e){console.error(e),y("idle"),v("error")}}),[c,s]);async function b(e){if("email"in s)await n.connect({chain:d,strategy:"email",email:s.email,verificationCode:e,client:c}),await(0,z.O)("email");else{if(!("phone"in s))throw new Error("Invalid userInfo");await n.connect({chain:d,strategy:"phone",phoneNumber:s.phone,verificationCode:e,client:c}),await(0,z.O)("phone")}}const M=async e=>{if("object"===typeof w&&6===e.length&&(y("idle"),"object"===typeof w&&n))try{y("verifying");if("USER_MANAGED"===w.recoveryShareManagement&&(w.isNewUser||w.isNewDevice))if(w.isNewUser)try{await b(e)}catch(r){if(!(r instanceof Error&&r.message.includes("encryption key")))throw r}else try{await b(e)}catch(r){if(!(r instanceof Error&&r.message.includes("encryption key")))throw r}else await b(e),t();y("valid")}catch(r){var i;r instanceof Error&&null!==r&&void 0!==r&&null!==(i=r.message)&&void 0!==i&&i.includes("PAYMENT_METHOD_REQUIRED")?y("payment_required"):y("invalid"),console.error("Authentication Error",r)}},W=(0,l.useRef)(!1);return(0,l.useEffect)((()=>{W.current||(W.current=!0,E())}),[E]),"base"===C?(0,i.jsxs)(f.mc,{fullHeight:!0,flex:"column",animate:"fadein",children:[(0,i.jsx)(f.mc,{p:"lg",children:(0,i.jsx)(f.rQ,{title:j.signIn,onBack:o})}),(0,i.jsx)(f.mc,{expand:!0,flex:"column",center:"y",children:(0,i.jsxs)("form",{onSubmit:e=>{e.preventDefault()},children:[(0,i.jsxs)(f.mc,{flex:"column",center:"x",px:"lg",children:[!u&&(0,i.jsx)(L.h,{y:"xl"}),(0,i.jsx)(T.E,{children:j.emailLoginScreen.enterCodeSendTo}),(0,i.jsx)(L.h,{y:"sm"}),(0,i.jsx)(T.E,{color:"primaryText",children:"email"in s?s.email:s.phone}),(0,i.jsx)(L.h,{y:"xl"})]}),(0,i.jsx)(k,{isInvalid:"invalid"===m,digits:6,value:g,setValue:e=>{p(e),y("idle")},onEnter:()=>{M(g)}}),"invalid"===m&&(0,i.jsxs)(h,{children:[(0,i.jsx)(L.h,{y:"md"}),(0,i.jsx)(T.E,{size:"sm",color:"danger",center:!0,children:j.emailLoginScreen.invalidCode})]}),"payment_required"===m&&(0,i.jsxs)(h,{children:[(0,i.jsx)(L.h,{y:"md"}),(0,i.jsx)(T.E,{size:"sm",color:"danger",center:!0,children:j.maxAccountsExceeded})]}),(0,i.jsx)(L.h,{y:"xl"}),(0,i.jsx)(f.mc,{px:u?"xxl":"lg",children:"verifying"===m?(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(f.mc,{flex:"row",center:"x",animate:"fadein",children:(0,i.jsx)(S.y,{size:"lg",color:"accentText"})})}):(0,i.jsx)(f.mc,{animate:"fadein",children:(0,i.jsx)(A.$n,{onClick:()=>M(g),variant:"accent",type:"submit",style:{width:"100%"},children:j.emailLoginScreen.verify})},"btn-container")}),(0,i.jsx)(L.h,{y:"xl"}),!u&&(0,i.jsx)(f.N1,{}),(0,i.jsxs)(f.mc,{p:u?void 0:"lg",children:["error"===w&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(T.E,{size:"sm",center:!0,color:"danger",children:j.emailLoginScreen.failedToSendCode})}),"sending"===w&&(0,i.jsxs)(f.mc,{flex:"row",center:"both",gap:"xs",style:{textAlign:"center"},children:[(0,i.jsx)(T.E,{size:"sm",children:j.emailLoginScreen.sendingCode}),(0,i.jsx)(S.y,{size:"xs",color:"secondaryText"})]}),"object"===typeof w&&(0,i.jsx)(I,{onClick:E,type:"button",children:j.emailLoginScreen.resendCode})]})]})})]}):null}const I=(0,x.OV)((()=>{const e=(0,m.Q)();return{all:"unset",color:e.colors.accentText,fontSize:y.J.sm,cursor:"pointer",textAlign:"center",fontWeight:500,width:"100%","&:hover":{color:e.colors.primaryText}}}));var W=t(37629),B=t(50503);const R=e=>(0,i.jsxs)("svg",{width:e.size,height:e.size,viewBox:"0 0 36 36",fill:"none","aria-hidden":"true",children:[(0,i.jsx)("path",{d:"M18.0001 15C17.2045 15 16.4414 15.3161 15.8788 15.8787C15.3162 16.4413 15.0001 17.2044 15.0001 18C15.0001 19.53 14.8501 21.765 14.6101 24",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),(0,i.jsx)("path",{d:"M21.0002 19.6801C21.0002 23.2501 21.0002 29.2501 19.5002 33.0001",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),(0,i.jsx)("path",{d:"M25.9348 31.53C26.1148 30.63 26.5798 28.08 26.6848 27",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),(0,i.jsx)("path",{d:"M2.99976 18C2.99976 14.8518 3.99032 11.7833 5.83112 9.22935C7.67193 6.67536 10.2697 4.76531 13.2563 3.76975C16.243 2.77419 19.4672 2.74359 22.4723 3.6823C25.4773 4.621 28.1108 6.48141 29.9998 9",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),(0,i.jsx)("path",{d:"M2.99976 24H3.01628",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),(0,i.jsx)("path",{d:"M32.7 24C33 21 32.8965 15.969 32.7 15",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),(0,i.jsx)("path",{d:"M7.49976 29.25C8.24976 27 8.99976 22.5 8.99976 18C8.99824 16.9783 9.17071 15.9638 9.50976 15",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),(0,i.jsx)("path",{d:"M12.9751 33C13.2901 32.01 13.6501 31.02 13.8301 30",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),(0,i.jsx)("path",{d:"M13.5 10.2C14.8686 9.40988 16.4211 8.99401 18.0014 8.99426C19.5818 8.99452 21.1342 9.41088 22.5025 10.2015C23.8708 10.9921 25.0069 12.129 25.7964 13.498C26.5859 14.867 27.001 16.4197 27 18V21",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})]});function F(e){const{client:n,connectModal:t,chain:o}=(0,r.c)(),{wallet:c,done:a}=e,[d,x]=(0,l.useState)("loading"),h=(0,l.useRef)(!1);return(0,l.useEffect)((()=>{h.current||(h.current=!0,(0,W.A1)(n).then((e=>{x(e?"login":"select")})).catch((()=>{x("select")})))}),[n]),(0,i.jsxs)(f.mc,{animate:"fadein",fullHeight:!0,flex:"column",children:[(0,i.jsx)(f.mc,{p:"lg",children:(0,i.jsx)(f.rQ,{title:"Passkey",onBack:e.onBack})}),(0,i.jsx)(f.mc,{px:"wide"===t.size?"xxl":"lg",expand:!0,flex:"column",center:"y",children:(0,i.jsxs)("div",{children:["loading"===d&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.x,{}),(0,i.jsx)(L.h,{y:"xxl"})]}),"select"===d&&(0,i.jsx)(P,{onSignin:()=>{x("login")},onSignup:()=>{x("signup")}}),"login"===d&&(0,i.jsx)(N,{wallet:c,client:n,done:a,onCreate:()=>{x("signup")},chain:o}),"signup"===d&&(0,i.jsx)(O,{wallet:c,client:n,done:a,chain:o})]})})]})}function N(e){const{wallet:n,done:t,client:r,chain:o}=e,[s,c]=(0,l.useState)("loading");async function a(){c("loading");try{await n.connect({client:r,strategy:"passkey",type:"sign-in",chain:o}),await(0,z.O)("passkey"),t()}catch{c("error")}}const d=(0,l.useRef)(!1);return(0,l.useEffect)((()=>{d.current||(d.current=!0,a())})),"loading"===s?(0,i.jsx)(_,{title:"Requesting Passkey",subtitle:"A pop-up prompt will appear to sign-in and verify your passkey"}):"error"===s?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Q,{onTryAgain:a,title:"Failed to Login"}),(0,i.jsx)(L.h,{y:"sm"}),(0,i.jsx)(A.$n,{variant:"outline",fullWidth:!0,onClick:e.onCreate,children:"Create a new Passkey"}),(0,i.jsx)(L.h,{y:"lg"})]}):null}function O(e){const{wallet:n,done:t,client:r,chain:o}=e,[s,c]=(0,l.useState)("loading");async function a(){c("loading");try{await n.connect({client:r,strategy:"passkey",type:"sign-up",chain:o}),await(0,z.O)("passkey"),t()}catch{c("error")}}const d=(0,l.useRef)(!1);return(0,l.useEffect)((()=>{d.current||(d.current=!0,a())})),"loading"===s?(0,i.jsx)(_,{title:"Creating Passkey",subtitle:"A pop-up prompt will appear to sign-in and verify your passkey"}):"error"===s?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Q,{onTryAgain:a,title:"Failed to create passkey"}),(0,i.jsx)(L.h,{y:"lg"})]}):null}function P(e){return(0,i.jsxs)(f.mc,{children:[(0,i.jsx)(L.h,{y:"xxl"}),(0,i.jsx)(f.mc,{flex:"row",center:"x",color:"accentText",children:(0,i.jsx)(R,{size:y.RK["4xl"]})}),(0,i.jsx)(L.h,{y:"xl"}),(0,i.jsx)(L.h,{y:"xxl"}),(0,i.jsx)(A.$n,{variant:"accent",onClick:e.onSignup,fullWidth:!0,children:"Create a Passkey"}),(0,i.jsx)(L.h,{y:"sm"}),(0,i.jsx)(A.$n,{variant:"outline",onClick:e.onSignin,fullWidth:!0,children:"I have a Passkey"}),(0,i.jsx)(L.h,{y:"lg"})]})}function Q(e){return(0,i.jsxs)(f.mc,{animate:"fadein",children:[(0,i.jsx)(L.h,{y:"xxl"}),(0,i.jsx)(f.mc,{flex:"row",center:"x",children:(0,i.jsx)(B.g,{size:y.RK["3xl"]})}),(0,i.jsx)(L.h,{y:"lg"}),(0,i.jsx)(T.E,{center:!0,color:"primaryText",size:"lg",children:e.title}),(0,i.jsx)(L.h,{y:"xl"}),(0,i.jsx)(L.h,{y:"xxl"}),(0,i.jsx)(A.$n,{variant:"accent",fullWidth:!0,onClick:e.onTryAgain,children:"Try Again"})]})}function _(e){return(0,i.jsxs)(f.mc,{animate:"fadein",children:[(0,i.jsx)(L.h,{y:"xxl"}),(0,i.jsxs)(f.mc,{flex:"row",center:"x",style:{position:"relative"},children:[(0,i.jsx)(S.y,{size:"4xl",color:"accentText"}),(0,i.jsx)(f.mc,{color:"accentText",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:(0,i.jsx)(R,{size:y.RK.xxl})})]}),(0,i.jsx)(L.h,{y:"xl"}),(0,i.jsx)(T.E,{center:!0,color:"primaryText",size:"lg",children:e.title}),(0,i.jsx)(L.h,{y:"md"}),(0,i.jsx)(T.E,{multiline:!0,center:!0,children:e.subtitle}),(0,i.jsx)(L.h,{y:"xxl"}),(0,i.jsx)(L.h,{y:"xxl"})]})}var H=t(11182);function D(e){var n;const t=e.locale,o=t.socialLoginScreen,s=(0,m.Q)(),{connectModal:c}=(0,r.c)(),[a,d]=(0,l.useState)(void 0),{done:x,wallet:h}=e,[u,j]=(0,l.useState)("connecting"),{client:g,chain:p}=(0,r.c)(),y=null===(n=e.state)||void 0===n?void 0:n.socialLogin,k=(0,l.useRef)(!1);return(0,l.useEffect)((()=>{k.current||y&&(k.current=!0,j("connecting"),y.connectionPromise.then((()=>{x(),j("connected")})).catch((()=>{j("error")})))}),[x,y]),(0,i.jsx)(f.mc,{animate:"fadein",flex:"column",fullHeight:!0,children:(0,i.jsxs)(f.mc,{flex:"column",expand:!0,p:"lg",style:{paddingBottom:0},children:[e.goBack&&(0,i.jsx)(f.rQ,{title:o.title,onBack:e.goBack}),"compact"===c.size?(0,i.jsx)(L.h,{y:"xl"}):null,(0,i.jsxs)(f.mc,{flex:"column",center:"both",expand:!0,style:{textAlign:"center",minHeight:"250px"},children:["error"!==u&&(0,i.jsxs)(f.mc,{animate:"fadein",children:[(0,i.jsx)(T.E,{color:"primaryText",center:!0,multiline:!0,style:{maxWidth:"250px"},children:o.instruction}),(0,i.jsx)(L.h,{y:"xl"}),(0,i.jsx)(f.mc,{center:"x",flex:"row",children:(0,i.jsx)(S.y,{size:"lg",color:"accentText"})}),(0,i.jsx)(L.h,{y:"xxl"})]}),"error"===u&&(0,i.jsxs)(f.mc,{animate:"fadein",children:[(0,i.jsx)(T.E,{color:"danger",children:o.failed}),a&&(0,i.jsx)(T.E,{color:"danger",children:a}),(0,i.jsx)(L.h,{y:"lg"}),(0,i.jsx)(A.$n,{variant:"primary",onClick:async()=>{try{const n=(0,H.C)(e.socialAuth,s);if(!n)throw new Error("Failed to open ".concat(e.socialAuth," login window"));j("connecting"),await h.connect({chain:p,strategy:e.socialAuth,openedWindow:n,closeOpenedWindow:e=>{e.close()},client:g}),await(0,z.O)(e.socialAuth),j("connected"),x()}catch(i){var n;j("error"),i instanceof Error&&null!==i&&void 0!==i&&null!==(n=i.message)&&void 0!==n&&n.includes("PAYMENT_METHOD_REQUIRED")&&d(t.maxAccountsExceeded),console.error("Error sign in with ".concat(e.socialAuth),i)}},children:o.retry}),(0,i.jsx)(L.h,{y:"xxl"})]})]})]})})}var U=t(78479);const $=function(e){const n=(0,o.Cl)(),t=(0,o.IU)(),l=n,a=(0,U.H)(),{connectModal:d}=(0,r.c)();if(!a)return(0,i.jsx)(s.x,{});const x="compact"===d.size?e.goBack:()=>{t({})},h=null!==l&&void 0!==l&&l.emailLogin?{email:l.emailLogin}:null!==l&&void 0!==l&&l.phoneLogin?{phone:l.phoneLogin}:void 0;return h?(0,i.jsx)(M,{userInfo:h,locale:a,done:e.done,goBack:x,wallet:e.wallet}):null!==l&&void 0!==l&&l.passkeyLogin?(0,i.jsx)(F,{wallet:e.wallet,done:e.done,onBack:x}):null!==l&&void 0!==l&&l.socialLogin?(0,i.jsx)(D,{socialAuth:l.socialLogin.type,locale:a,done:e.done,goBack:x,wallet:e.wallet,state:l}):(0,i.jsx)(c.w,{select:()=>{},locale:a,done:e.done,goBack:e.goBack,wallet:e.wallet})}}}]);
//# sourceMappingURL=75791.47c2ce6d.chunk.js.map